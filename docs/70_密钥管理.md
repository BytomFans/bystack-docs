---
id: docs_70
title: 密钥管理
sidebar_label: 密钥管理
---

## 生成

## KeyStore文件

## 签名

**sign**

输入：

xprv，扩展的私钥。
message，表示要签名的消息的可变长度字节序列。
输出： (R,S)，表示EdDSA签名的64字节字符串。

拆分xprv为两个部分：32字节privkey和32字节salt。
假设s是privkey使用little-endian表示法解码的标量。
让h = Hash512(0x02 || privkey || salt)。
我们prefix是上半年h：prefix = h[0:32]。
执行固定基数标量乘法P = s*B，其中BEd25519是基点。
将点编码P为pubkey。
计算Hash512(prefix || message)。将64字节的摘要解释为little-endian整数r。
计算点r*B。为了提高效率，请先降低的r模数L（的组顺序）来实现B。
令字符串R为point的编码r*B。
计算Hash512(R || pubkey || message)并将64字节的摘要解释为little-endian整数k。
计算S = (r + k * s) mod L。为了提高效率，请再次降低k模数L。
串联R（32个字节），并进行Little-endian编码S（32个字节，最后一个字节的三个最高有效位始终为零）。
返回(R,S)（64个字节）。